SELECT datname AS "Database Name",
       pg_get_userbyid(datdba) AS "Owner",
       pg_encoding_to_char(encoding) AS "Encoding",
       datcollate AS "Collate",
       datctype AS "Ctype",
       datistemplate AS "Is Template",
       datallowconn AS "Allow Connections"
FROM pg_database
WHERE datname NOT IN ('template0', 'template1')
ORDER BY "Database Name";


SELECT n.nspname as schema_name,
       t.typname as type_name,
       CASE
           WHEN t.typtype = 'e' THEN 'enum'
           WHEN t.typtype = 'c' THEN 'composite'
           WHEN t.typtype = 'r' THEN 'range'
           ELSE 'other'
       END as type_category
FROM pg_type t
JOIN pg_namespace n ON n.oid = t.typnamespace
WHERE n.nspname NOT IN ('pg_catalog', 'information_schema')
AND t.typrelid = 0  -- Exclude table row types
AND NOT EXISTS (
    SELECT 1
    FROM pg_catalog.pg_type el
    WHERE el.oid = t.typelem AND el.typarray = t.oid
);



RUN apt-get install -y postgresql-9.6 postgresql-client-9.6 postgresql-contrib-9.6
RUN pg_createcluster 9.6 main
RUN echo "listen_addresses = '*'" >> /etc/postgresql/9.6/main/postgresql.conf
RUN echo "host  all  all 0.0.0.0/0 md5">>/etc/postgresql/9.6/main/pg_hba.conf


   usermod -aG sudo pompom \
    su pompom

    USER postgres
    RUN pg_ctl -D /usr/local/pgsql/data initdb
    RUN chown postgres /usr/local/pgsql/data
    RUN /usr/lib/postgresql/16/bin/pg_ctl -D /usr/local/pgsql/data -l logfile start
RUN postgres -D /usr/local/pgsql/data



RUN  pg_ctl -D /usr/local/pgsql/data initdb


RUN sudo adduser pompom --disabled-password
RUN echo "pompom:pompom" | sudo chpasswd



RUN mkdir -p /usr/local/pgsql/data
RUN chown postgres /usr/local/pgsql/data
USER postgres


RUN  pg_ctl -D /usr/local/pgsql/data initdb
RUN echo "host  all  all 0.0.0.0/0 md5">> /usr/local/pgsql/data/pg_hba.conf
--------------------------------
CREATE TYPE my_composite_type AS (
    id INTEGER,
    description TEXT
);
--------------------------------
CREATE TABLE all_data_types (
    serial_col SERIAL PRIMARY KEY,        -- 自動インクリメントの整数
    int_col INTEGER,                      -- 整数
    smallint_col SMALLINT,                -- 小さい整数
    bigint_col BIGINT,                    -- 大きい整数
    decimal_col DECIMAL(10, 2),           -- 固定小数点数
    numeric_col NUMERIC(10, 2),           -- 固定小数点数
    real_col REAL,                        -- 単精度浮動小数点数
    double_col DOUBLE PRECISION,          -- 倍精度浮動小数点数
    money_col MONEY,                      -- 通貨型
    char_col CHAR(10),                    -- 固定長文字列
    varchar_col VARCHAR(255),             -- 可変長文字列
    text_col TEXT,                        -- テキスト
    bytea_col BYTEA,                      -- バイナリデータ
    date_col DATE,                        -- 日付
    time_col TIME,                        -- 時間
    timetz_col TIME WITH TIME ZONE,       -- タイムゾーン付き時間
    timestamp_col TIMESTAMP,              -- タイムスタンプ
    timestamptz_col TIMESTAMP WITH TIME ZONE, -- タイムゾーン付きタイムスタンプ
    interval_col INTERVAL,                -- 時間間隔
    boolean_col BOOLEAN,                  -- ブール値
    point_col POINT,                      -- 幾何座標
    line_col LINE,                        -- 幾何線
    lseg_col LSEG,                        -- 線分
    box_col BOX,                          -- 矩形
    path_col PATH,                        -- パス（点の集合）
    polygon_col POLYGON,                  -- 多角形
    circle_col CIRCLE,                    -- 円
    cidr_col CIDR,                        -- IPアドレス/ネットワーク
    inet_col INET,                        -- IPアドレス
    macaddr_col MACADDR,                  -- MACアドレス
    uuid_col UUID,                        -- UUID
    json_col JSON,                        -- JSONデータ
    jsonb_col JSONB,                      -- JSONデータ（二進形式）
    xml_col XML,                          -- XMLデータ
    array_col INTEGER[],                  -- 配列
    composite_col my_composite_type       -- 複合型
);